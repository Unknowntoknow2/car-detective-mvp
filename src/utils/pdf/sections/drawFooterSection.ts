<<<<<<< HEAD

import { rgb } from 'pdf-lib';
import { SectionParams } from '../types';

export async function drawFooterSection(params: SectionParams): Promise<number> {
  const { page, fonts, options, margin, pageWidth } = params;
  const y = params.y ?? 30;
  const textColor = params.textColor || rgb(0.1, 0.1, 0.1);
  
  // Draw horizontal line
  page.drawLine({
    start: { x: margin, y: y + 15 },
    end: { x: pageWidth - margin, y: y + 15 },
    thickness: 0.5,
    color: rgb(0.8, 0.8, 0.8),
  });
  
  // Draw footer text
  if (options.includeFooter && options.footerText) {
    page.drawText(options.footerText, {
      x: pageWidth / 2 - 100,
      y: y - 5,
      size: 8,
      font: fonts.regular,
      color: rgb(0.5, 0.5, 0.5),
=======
import { SectionParams } from "../types";

export function drawFooterSection(params: SectionParams) {
  const { doc, pageWidth, margin, regularFont, boldFont } = params;
  const footerText = "Generated by Vehicle Valuation Tool";
  const pageNumberText = `Page ${doc.page}`;
  const fontSize = 10;

  // Use the correct method to calculate text width based on the PDF library
  const footerTextWidth = doc.widthOfString
    ? doc.widthOfString(footerText, { font: regularFont, size: fontSize })
    : 100; // Fallback width

  const pageNumberTextWidth = doc.widthOfString
    ? doc.widthOfString(pageNumberText, { font: regularFont, size: fontSize })
    : 50; // Fallback width

  const xFooterText = margin;
  const yFooter = doc.pageHeight ? doc.pageHeight() - margin - 5 : 700; // Fallback position

  doc.font(regularFont, fontSize)
    .fillColor("gray")
    .text(footerText, xFooterText, yFooter, {
      align: "left",
      width: pageWidth - 2 * margin,
    });

  const xPageNumberText = pageWidth - margin - pageNumberTextWidth;

  doc.font(regularFont, fontSize)
    .fillColor("gray")
    .text(pageNumberText, xPageNumberText, yFooter, {
      align: "right",
      width: pageWidth - 2 * margin,
>>>>>>> 17b22333 (Committing 1400+ updates: bug fixes, file sync, cleanup)
    });
  }
  
  return y - 10;
}
